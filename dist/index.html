<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="/favicon.ico"><title>Erudit</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css"><style>@media (width < 600px) {
	  html {
		 width : fit-content;
		}

	}
	@media (min-width : 1000px) {
	.navbar.bottom {
		display : none!important;
	  }
	}</style><link href="/css/app.5f12487f.css" rel="preload" as="style"><link href="/js/app.c065728b.js" rel="preload" as="script"><link href="/js/chunk-vendors.c9f5eef0.js" rel="preload" as="script"><link href="/css/app.5f12487f.css" rel="stylesheet"></head><body><noscript><strong>We're sorry but compostmap doesn't work properly without JavaScript enabled. Please enable it to continue.</strong></noscript><button id="authorize_button" style="display: none;"></button> <button id="signout_button" style="display: none;"></button> <button id="get_data_excel" style="display: none;"></button> <span id="spreadsheetId" style="display: none;"></span> <span id="range" style="display: none;"></span><div id="app"></div><script>// Client ID and API key from the Developer Console
      var CLIENT_ID = '843497641662-qarkcml1firr06et8kej886q1n39ipn6.apps.googleusercontent.com';
      var API_KEY = 'AIzaSyCx8f68Dsft0_mg3X1JuPBYFVW0MeP60Y8';
	  //jacok57228@nitynote.com

      // Array of API discovery doc URLs for APIs used by the quickstart
      var DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];

      // Authorization scopes required by the API; multiple scopes can be
      // included, separated by spaces.
      var SCOPES = "profile email https://www.googleapis.com/auth/spreadsheets.readonly";

      var authorizeButton = document.getElementById('authorize_button');
      var signoutButton = document.getElementById('signout_button');
	  var get_data_excel = document.getElementById('get_data_excel');
	  get_data_excel.onclick = handle_get_data_excel;

      /**
       *  On load, called to load the auth2 library and API client library.
       */
      function handleClientLoad() {
        gapi.load('client:auth2', initClient);
      }

      /**
       *  Initializes the API client library and sets up sign-in state
       *  listeners.
       */
	  
      function initClient() {
        gapi.client.init({
          apiKey: API_KEY,
          clientId: CLIENT_ID,
          discoveryDocs: DISCOVERY_DOCS,
          scope: SCOPES
        }).then(function (data) {
			console.log(data);
          // Listen for sign-in state changes.
          gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);

          // Handle the initial sign-in state.
          updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
          authorizeButton.onclick = handleAuthClick;
          signoutButton.onclick = handleSignoutClick;
        }, function(error) {
          appendPre(JSON.stringify(error, null, 2));
        });
      }

      /**
       *  Called when the signed in status changes, to update the UI
       *  appropriately. After a sign-in, the API is called.
       */
	   
      function updateSigninStatus(isSignedIn) {
	  console.log(isSignedIn);
		localStorage.setItem("isSignedIn", isSignedIn);
		if (isSignedIn) {
		
			
			var profile = gapi.auth2.getAuthInstance().currentUser.get().getBasicProfile();
			console.log(profile.yv);
			
			localStorage.setItem('email', profile.yv);
			var spreadsheet = localStorage.getItem('spreadsheetId');
			if (spreadsheet != null) {
				document.getElementById('spreadsheetId').innerHTML = spreadsheet;
				handle_get_data_excel(false);
			}
			//window.location.href="http://localhost:8072/login";
		} else {
			localStorage.clear();
		}
		/*
        if (isSignedIn) {
          authorizeButton.style.display = 'none';
          signoutButton.style.display = 'block';
          listMajors();
        } else {
          authorizeButton.style.display = 'block';
          signoutButton.style.display = 'none';
        }
		*/
      }

      /**
       *  Sign in the user upon button click.
       */
      function handleAuthClick(event) {
        gapi.auth2.getAuthInstance().signIn();
		
      }

      /**
       *  Sign out the user upon button click.
       */
      function handleSignoutClick(event) {
        gapi.auth2.getAuthInstance().signOut();
      }

      /**
       * Append a pre element to the body containing the given message
       * as its text node. Used to display the results of the API call.
       *
       * @param {string} message Text to be placed in pre element.
       */
      function appendPre(message) {
        var pre = document.getElementById('content');
        var textContent = document.createTextNode(message + '\n');
        pre.appendChild(textContent);
      }

      /**https://docs.google.com/spreadsheets/d/1PcuPqNiXu3L68hWIK6neAIe6M5fRST4vR8af3d6fXS4/edit?usp=sharing
       * Print the names and majors of students in a sample spreadsheet:
       * https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit
       */
      function handle_get_data_excel(redirect=true) {
			
	  
			gapi.client.sheets.spreadsheets.values.get({
			  spreadsheetId: document.getElementById('spreadsheetId').innerHTML,
			  range: 'Meta-donnees!A2:C',
			}).then(function(response) {
			  localStorage.setItem('meta_donnee', JSON.stringify(response.result));
			  console.log('reponse meta_donnee');
			  console.log(response.result);
			  			gapi.client.sheets.spreadsheets.values.get({
						  spreadsheetId: document.getElementById('spreadsheetId').innerHTML,
						  range: 'Exercices!A2:O',
						}).then(function(response) {
						  localStorage.setItem('exercices', JSON.stringify(response.result));
						  console.log('reponse exercices');
						  console.log(response.result);
						  gapi.client.sheets.spreadsheets.values.get({
							  spreadsheetId: document.getElementById('spreadsheetId').innerHTML,
							  range: 'Contact!A2:E',
							}).then(function(response) {
							  localStorage.setItem('contact', JSON.stringify(response.result));
							  console.log('reponse contact');
							  console.log(response.result);
							  if(redirect) {
									localStorage.setItem('spreadsheetId', document.getElementById('spreadsheetId').innerHTML);
									window.location.href="http://localhost:8072/";
								}
							 
							}, function(response) {
								console.log('Error: ' + response.result.error.message);
							});
						 
						}, function(response) {
							console.log('Error: ' + response.result.error.message);
						});
			  
			 
			}, function(response) {
				alert('Error: ' + response.result.error.message);
			});

			
      }
	  
	  var originalSetItem = localStorage.setItem; 
		localStorage.setItem = function(){
			document.createEvent('Event').initEvent('itemInserted', true, true);
			originalSetItem.apply(this, arguments);
		}</script><script async defer src="https://apis.google.com/js/api.js" onload="this.onload=function(){};handleClientLoad()" onreadystatechange="if (this.readyState === 'complete') this.onload()"></script><script src="/js/chunk-vendors.c9f5eef0.js"></script><script src="/js/app.c065728b.js"></script></body></html>